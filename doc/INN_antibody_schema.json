
{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"title": "INN Antibody Annotations",
	"description": "Annotations for a therapeutic antibody that has been published in a WHO International Nonprietary Name (INN) list and has made it through pre-clinical trials. The annotations are generated by a parser (https://github.com/pySin/Antibody-Annotation-to-JSON) that reads in a flat file format and converts it to the JSON data structure described by this schema.",
	"type": "object",
	"$ref": "#/$defs/requiredProps",
	"unevaluatedProperties": false,
	"properties": {
		"Request": {
			"type": "string",
			"pattern": "^[0-9]{5}$",
			"description": "The unique ID assigned to the INN application by the World Health Organisation. Usually a 5 digit string.",
			"examples": [
				"11678",
				"12023"
			],
			"$comment": "TODO: check if it's always 5 digits"
		},
		"Format": {
			"type": "string",
			"pattern": ".+monoclonal.+antibody",
			"description": "The overall nature of the molecule. Begins with optional indicators of conjugation, multispecificity and fusions. This is followed by the source (slash-separated if more than one), the words `monoclonal antibody`, and optional details about the type of antibody fragments/domains, details of multimerization and non-antibody fusions",
			"examples": [
				"human monoclonal antibody",
				"conjugated humanized monoclonal antibody",
				"bispecific humanized/human monoclonal antibody",
				"human monoclonal antibody Fc fusion with human TACI fragment",
				"tetraspecific humanized/chimeric scFv-Ab-scFv-scFv monoclonal antibody",
				"murine monoclonal antibody scFv fusion with Shiga-like toxin 1 subunit A (stxA)"
			],
			"$comment": "a more complete regex pattern could be used if the order of information is made consistent"
		},
		"Format-Note": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"Value": {
								"type": "string",
								"minLength": 2,
								"description": "The content of the note for the instances given in the item",
								"examples": [
									"transgenic mouse with human genes",
									"human Fab antibody phage display library"
								],
								"$comment": "The purpose of minLength is to disallow empty strings (2 is a somewhat arbitrary choice)."
							}
						}
					}
				}
			],
			"description": "Notes that provide further context, detail or clarification on information in the `Format` property",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"Value": "Homo sapiens synthetic phage display library"
					}
				],
				[
					{
						"Instances": [ 1 ],
						"Value": "transgenic mouse with human genes"
					},
					{
						"Instances": [ 2 ],
						"Value": "human Fab antibody phage display library"
					}
				]
			]
		},
		"ID": {
			"type": "string",
			"minLength": 3,
			"description": "Used to provide an original identifier for the antibody (e.g. clone name, lab code, etc)",
			"examples": [
				"IAB22M2C",
				"GNC-038",
				"DS-6016a",
				"SI-B003, SI-3X35, SI-3"
			],
			"$comment": "Sometimes the string is a comma-separated list of two or more alternative IDs. Consider changing the property type to array"
		},
		"AbML": {
			"type": "string",
			"minLength": 2,
			"description": "A notation language for describing antibody formats in terms of domains - their order within chains, associations in space, disulfide linkages, and various other annotations. See http://www.bioinf.org.uk/abs/abml/ for more information.",
			"examples": [
				"X(1)-L(2)-VH(3:5)-L(4)-VL(5:3)","VL(1:3)-CL^(2:4){1}|VH(3:1)-CH1(4:2){1}-H*(5:12){2}-CH2(6:13)-CH3(7:14)|VL(8:10)-CL^(9:11){1}|VH(10:8)-CH1(11:9){1}-H*(12:5){2}-CH2(13:6)-CH3(14:7)",
				"VL(1:3)-L(2)-VH(3:1)-H*(4:10){3}[MOD:REMCYS][NOTE: Nter 5aa extension Cter 2aa extension]-L(5)-CH3(6:12)|VL(7:9)-L(8)-VH(9:7)-H(10:4){3}[MOD:REMCYS][NOTE: Nter 5aa extension Cter 2aa extension]-L(11)-CH3(12:6)"
			],
			"$comment": "A Regex pattern could be added but it would be quite complicated"
		},
		"Source": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"Value": {
								"type": "string",
								"minLength": 3,
								"description": "The `Source` annotation for the chain comprising the instances given in the item",
								"examples": [
									"human",
									"humanized",
									"chimeric"
								]
							}
						}
					}
				}
			],
			"description": "States the source of two or more chains when they are of different origins and the antibody is a non-standard format. In standard antibodies, (Heavy|Light)Source is used instead.",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"Value": "human"
					},
					{
						"Instances": [ 2, 3 ],
						"Value": "humanized"
					}
				]
			]
		},
		"Fusion": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 2
							}
						}
					}
				}
			],
			"description": "Indicates instances that are fused together to form single chains",
			"examples": [
				[
					{
						"Instances": [ 3, 4, 5 ]
					},
					{
						"Instances": [ 6, 7 ]
					}
				]
			]
		},
		"Domains": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Values"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"Values": {
								"type": "array",
								"minItems": 1,
								"uniqueItems": true,
								"items": {
									"type": "string",
									"enum": [ "VL", "VH", "VHH", "CL", "CH1", "CH2", "CH3", "CH4", "hinge", "OTHER" ]
								},
								"description": "The list of domains, in order from N to C terminus, using their abbreviated names. VHH is a camelid heavy chain variable domain, and OTHER represents any non-antibody domain.",
								"examples": [
									[ "VL", "CL" ],
									[ "VH", "CH1", "CH2", "CH3" ],
									[ "VL", "VH", "OTHER" ],
									[ "hinge" ]
								]
							}
						}
					}
				}
			],
			"description": "Used with proteins such as CrossMabs to indicate (in order, from N to C terminus) the domains present in each instance or chain of fused instances. Linkers are not listed.",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"Values": [ "VH", "CH1", "CH2", "CH3" ]
					},
					{
						"Instances": [ 2 ],
						"Values": [ "VL", "CL" ]
					},
					{
						"Instances": [ 3 ],
						"Values": [ "VH", "CH1", "CH2", "CH3" ]
					},
					{
						"Instances": [ 4, 5 ],
						"Values": [ "VH", "CL" ]
					},
					{
						"Instances": [ 6, 7 ],
						"Values": [ "VL", "CH1" ]
					}
				],
				[
					{
						"Instances": [ 1, 2, 3],
						"Values": [ "OTHER", "VH", "VL" ]
					}
				]
			]
		},
		"Type": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Instances": {
								"minItems": 1,
								"$comment": "TODO: check whether maxItems should be 2"
							},
							"Value": {
								"type": "string",
								"minLength": 1,
								"anyOf": [
									{ "pattern": "^IgG[1-4](\/IgG[1-4])*-(kappa|lambda)(\/(kappa|lambda))*( (Crossmab|Fab|scFab|VHFc|XscFv))?$" },
									{ "pattern": "^Fv-(heavy|kappa|lambda) scFv( dimer)?$" },
									{ "pattern": "^Gamma[1-4]-hcAb$", "$comment": "e.g. in Record 12381" },
									{ "pattern": "^CH[1-4]-Gamma[1-4]$", "$comment": "e.g. in Record 11678" },
									{ "enum": [ "VHH", "hinge", "Fc", "single-domain", "OTHER" ], "$comment": "`hinge` e.g. in Record 11678; `Fc` e.g. in Records 12197, 12264, and 12295; `VHH` e.g. in Record 12204" }
								],
								"description": "The `Type` annotation for the instance(s) given in the item. See full description in parent property.",
								"examples": [
									"IgG1-kappa",
									"IgG2/IgG4-lambda",
									"IgG1-kappa/lambda",
									"Fv-heavy scFv",
									"Fv-kappa scFv dimer",
									"OTHER"
								],
								"$comment": "The patterns may be too restrictive, so consider extending, simplifying or removing them. Also note that the anyOf array is used for clarity, even though the same effect could be achieved in a single very long pattern."
							}
						}
					}
				}
			],
			"description": "This is a summary of the antibody type describing the nature of both heavy and light chains. There may be multiple such descriptions (one for each instance or pair of instances) in non-standard antibody formats. The basic format for each description is the heavy and light class separated by a dash. When a chain is a fusion from different sources, there may be two or more slash-separated classes. There is an optional indicator of a special format (e.g. `Crossmab` or `Fab`). Single-chain variable fragments (scFvs) follow a slightly different format, with a separate annotation for each of the two domains, and an optional indicator of dimerization. Finally, there are various miscellaneous types that may be specified, such as `single-domain` for nanobodies or `OTHER` for non-antibody proteins.",
			"examples": [
				[
					{
						"Instances": [ 0 ],
						"Value": "IgG4-lambda"
					}
				],
				[
					{
						"Instances": [ 1 ],
						"Value": "Fv-kappa scFv"
					},
					{
						"Instances": [ 2 ],
						"Value": "Fv-heavy scFv"
					},
					{
						"Instances": [ 3 ],
						"Value": "IgG1-kappa"
					},
					{
						"Instances": [ 4 ],
						"Value": "Fv-heavy scFv"
					},
					{
						"Instances": [ 5 ],
						"Value": "Fv-kappa scFv"
					},
					{
						"Instances": [ 6 ],
						"Value": "Fv-heavy scFv"
					},
					{
						"Instances": [ 7 ],
						"Value": "Fv-kappa scFv"
					},
					{
						"Instances": [ 8 ],
						"Value": "IgG1-kappa"
					}
				],
				[
					{
						"Instances": [ 1, 2 ],
						"Value": "IgG1-lambda"
					},
					{
						"Instances": [ 1, 3 ],
						"Value": "IgG1-kappa"
					}
				]
			]
		},
		"Conjugate": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"items": {
						"required": [
							"DrugName"
						],
						"properties": {
							"DrugName": {
								"type": "string",
								"minLength": 1,
								"description": "The name of the conjugated drug molecule; usually the generic INN-assigned name",
								"examples": [
									"tazide",
									"paquemicin"
								]
							}
						}
					}
				}
			],
			"description": "This property is only used when the antibody is conjugated to a drug molecule and indicates the name of the conjugated drug. Details of the linker are not included. The possibility of multi-payload antibody-drug conjugates means that this property's value is an array of objects (like all other instance-specific properties) rather than a single object.",
			"examples": [
				[
					{
						"Instance": [ 0 ],
						"DrugName": "tazide"
					}
				]
			]
		},
		"PDB": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"ID"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"ID": {
								"type": "string",
								"pattern": "^[1-9][a-zA-Z0-9]{3}$",
								"description": "The 4-character alphanumeric PDB identifier. Letters may be lowercase",
								"examples": [
									"7ahv",
									"7ahu"
								],
								"$comment": "TODO: check if the ID is always written in the lower-case form"
							}
						}
					}
				}
			],
			"description": "The Protein Data Bank (PDB) identifier (if an experimentally-determined structure exists) for the chain or domains covered by the given instances",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"ID": "7ahv"
					},
					{
						"Instances": [ 2 ],
						"ID": "7ahu"
					}
				]
			]
		},
		"HeavyChainClass": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"$ref": "#/$defs/heavyDomainsInItems"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Value": {
								"anyOf": [
									{
										"type": "string",
										"pattern": "^Gamma[1-4]$"
									},
									{
										"type": "null"
									}
								],
								"description": "The name of the class; null is optionally used for an Fv type (VH domain)."
							}
						}
					}
				}
			],
			"description": "The heavy chain class for the chain or domain(s) covered by the given instance. It must match the heavy chain specification given in the `Type` property item that includes the same instance. Where the heavy chain is a composite of more than one class, there are separate items for each group of one or more domains of the same class.",
			"examples": [
				[
					{
						"Instance": 0,
						"Value": "Gamma1"
					}
				],
				[
					{
						"Instance": 2,
						"Domains": [ "CH1" ],
						"Value": "Gamma4"
					},
					{
						"Instance": 2,
						"Domains": [ "CH2", "CH3" ],
						"Value": "Gamma1"
					},
					{
						"Instance": 3,
						"Value": null
					}
				]
			]
		},
		"LightChainClass": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"$ref": "#/$defs/lightDomainInItems"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Value": {
								"type": "string",
								"enum": [ "kappa", "lambda" ]
							}
						}
					}
				}
			],
			"description": "The light chain class for the chain or domain(s) covered by the given instance. It must match the light chain specification given in the `Type` property item that includes the same instance. Where the light chain is a composite of two classes, there are separate items for the VL and CL domains (see below example).",
			"examples": [
				[
					{
						"Instance": 1,
						"Domain": "VL",
						"Value": "kappa"
					},
					{
						"Instance": 1,
						"Domain": "CL",
						"Value": "lambda"
					}
				],
				[
					{
						"Instance": 1,
						"Value": "kappa"
					},
					{
						"Instance": 5,
						"Value": "kappa"
					},
					{
						"Instance": 7,
						"Value": "kappa"
					},
					{
						"Instance": 8,
						"Value": "kappa"
					}
				]
			]
		},
		"ChainLength": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Value"
						],
						"properties": {
							"Instances": {
								"minItems": 2
							},
							"Value": {
								"type": "integer",
								"minimum": 1,
								"description": "The number of residues in the chain"
							}
						}
					}
				}
			],
			"description": "The total number of amino acids in chains that cannot be assigned as predominantly heavy or light, such as in scFv/scFab/XscFv (DART) proteins, or fusions with non-antibody proteins. It is the full length of each chain including (perhaps) light and heavy domains and any fusion proteins.",
			"examples": [
				[
					{
						"Instances": [ 1, 2, 3, 4, 5, 6, 7 ],
						"Value":  1230
					}
				],
				[
					{
						"Instances": [ 3, 4, 5 ],
						"Value":  702
					},
					{
						"Instances": [ 6, 7 ],
						"Value":  215
					}
				]
			],
			"$comment": "The items in this property always describe two or more instances, whereas in `(Heavy|Light)ChainLength` they only ever describe a single instance"
		},
		"ConfirmedPTM": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 1
							}
						}
					}
				},
				{
					"$ref": "#/$defs/confirmedPTMItemProps"
				}
			],
			"description": "Like `#/patternProperties/^(Heavy|Light)ConfirmedPTM$`, but used for linker regions and chains that cannot be assigned as predominantly heavy or light. Each item refers to an array of instances, although only linker regions use two instances - in all other cases (fusion chains), the annotations refer to a single instance within the larger chain.",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"Type": "formylglycine",
						"Positions": [ 59 ]
					}
				],
				[
					{
						"Instances": [ 4, 5 ],
						"Type": "hydroxylation",
						"PositionsPartial": [ 372, 377 ]
					}
				]
			]
		},
		"CysPositions": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Values"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"Values": {
								"$ref": "#/$defs/residuePositionsArray",
								"description": "The cysteine positions(s) for the instance(s) given in the item. Uses sequential numbering as observed in the final protein."
							}
						}
					}
				}
			],
			"description": "An array of cysteine positions in each chain that cannot be assigned as predominantly heavy or light",
			"examples": [
				[
					{
						"Instances": [ 1, 2 ],
						"Values": [ 23, 92, 140, 196, 216, 222, 225, 257, 317, 350, 363, 421 ]
					},
					{
						"Instances": [ 1, 2 ],
						"Values": [ 22, 96, 147, 207, 227 ]
					}
				]
			],
			"$comment": "See also: `#/patternProperties/^(Heavy|Light)CysPositions$`"
		},
		"DisulfidesIntra": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 1
							}
						}
					}
				},
				{
					"$ref": "#/$defs/disulfidesIntraItemProps"
				}
			],
			"description": "Arrays of residue pairs involved in intra-chain disulfide bonds in each instance (or between linked instances) of a chain that cannot be assigned as predominantly heavy or light. Separate items are used in cases of multiple disulfide isoforms, and these are indicated in the optional `Isoform` subproperty.",
			"examples": [
				[
					{
						"Instances": [ 1 ],
						"Positions": [
							[ 146, 159 ],
							[ 397, 407 ]
						]
					}
				]
			],
			"$comment": "TODO: check if linker regions can have disulfides; if not, this property will only ever refer to single instances, so it can be aggregated with the (Heavy|Light) patternProperty"
		},
		"DisulfidesInterH1H2": {
			"allOf": [				
				{
					"$ref": "#/$defs/disulfidesInterItemProps"
				},
				{
					"items": {
						"required": [
							"InstanceX",
							"InstanceY"
						],
						"properties": {
							"Positions": {
								"not": {
									"type": "null"
								},
								"$comment": "TODO: check if null is in fact a valid type for `Positions` (if the heavy chains can be linked/stabilised with compensatory modifications?)"
							}
						}
					}
				}
			],
			"description": "Lists residue pairs involved in inter-chain disulfides between the two heavy chains (which often have the same instance number, as in standard formats, but this isn't the case for many other formats). Uses sequential numbering as observed in the final protein. Separate items are used in cases of multiple disulfide isoforms, and these are indicated in the optional `Isoform` subproperty at the root level of the items (not within the `Positions` items). In most cases, this property will have only one item (if there are no isoforms) with between two and four disulfide pairs.",
			"examples": [
				[
					{
						"InstanceX": 3,
						"InstanceY": 3,
						"Isoform": "A",
						"Positions": [
							{
								"X": 492,
								"Y": 492
							},
							{
								"X": 495,
								"Y": 495
							}
						]
					},
					{
						"InstanceX": 3,
						"InstanceY": 3,
						"Isoform": "B",
						"Positions": [
							{
								"X": 492,
								"Y": 495
							},
							{
								"X": 495,
								"Y": 498
							}
						]
					}
				]
			],
			"$comment": "TODO: check if it's theoretically possible to have a DisulfidesInterH3H4 annotation, in which case that could be included in a pattern property."
		},
		"DisulfidesInter": {
			"allOf": [
				{
					"$ref": "#/$defs/disulfidesInterItemProps"
				},
				{
					"items": {
						"required": [
							"InstanceX",
							"InstanceY"
						]						
					}
				}			
			],
			"description": "Lists residue pairs involved in inter-chain disulfides between chains that cannot be assigned as predominantly heavy or light, or in cases where the same instance light chain interacts with multiple instances of heavy chains (or vice versa). Uses sequential numbering as observed in the final protein. Separate items are used in cases of multiple disulfide isoforms, and these are indicated in the optional `Isoform` subproperty at the root level of the items (not within the `Positions` items).",
			"examples": [
				[
					{
						"InstanceX": 5,
						"InstanceY": 7,
						"Positions": [
							{
								"X": 702,
								"Y": 215
							}
						]
					}
				]
			],
			"$comment": "TODO: We could consider aggregating all of the DisulfidesInter* properties by moving the chain pair suffix out of the property name and into an item subproperty"
		},
		"HCGermline": {
			"allOf": [
				{
					"$ref": "#/$defs/germlineProps"
				},
				{
					"$ref": "#/$defs/heavyDomainsInItems"
				}
			],
			"description": "The IMGT germline assignment (including species name) for the heavy chain constant fragment of each heavy chain instance. Where the constant domains of a single instance come from different germlines, each domain or group of domains is recorded in a separate item and the optional `Domains` subproperty is used.",
			"examples": [
				[
					{
						"Instance": 3,
						"Species": "Homo sapiens",
						"GeneID": "IGHG1*01"
					},
					{
						"Instance": 6,
						"Species": "Homo sapiens",
						"GeneID": "IGHG1*09"
					}
				],
				[
					{
						"Instance": 3,
						"Domains": [ "CH1" ],
						"Species": "Homo sapiens",
						"GeneID": "IGHG1*01"
					},
					{
						"Instance": 3,
						"Domains": [ "CH2", "CH3" ],
						"Species": "Homo sapiens",
						"GeneID": "IGHG1*09"
					}
				]
			],
			"$comment": "See also: `#/properties/LCGermline` and `#/patternProperties/^(HV|HJ|LV|LJ)Germline$`"
		},
		"LCGermline": {
			"allOf": [
				{
					"$ref": "#/$defs/germlineProps"
				},
				{
					"items": {
						"properties": {
							"Domain": {
								"type": "string",
								"const": "CL",
								"description": "An optional indicator of the domain, for cases when the variable and constant domains come from different germline loci"
							}
						}
					},
					"$comment": "`#/$defs/lightDomainInItems` is not used because in this case `VL` is not a valid value"
				}
			],
			"description": "The IMGT germline assignment (including species name) for the light chain constant fragment of each light chain instance. Where the CL and VL domains come from different germlines (or in formats like Crossmabs), this is indicated with `CL` in the optional `Domain` subproperty.",
			"examples": [
				[
					{
						"Instance": 8,
						"Domain": "CL",
						"Species": "Homo sapiens",
						"GeneID": "IGKC*01"
					}
				]
			],
			"$comment": "See also: `#/properties/HCGermline` and `#/patternProperties/^(HV|HJ|LV|LJ)Germline$`"
		},
		"CHSRange": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"items": {
						"required": [
							"Start",
							"End"
						],
						"properties": {
							"Start": {
								"anyOf": [
									{
										"type": "null"
									},
									{
										"type": "integer",
										"minimum": 1
									}
								],
								"description": "The position of the first residue in the range, using sequential numbering as observed in the final protein",
								"examples": [ 448, 812, null ]
							},
							"End": {
								"anyOf": [
									{
										"type": "null"
									},
									{
										"type": "integer",
										"minimum": 1
									}
								],
								"description": "The position of the last residue in the range, using sequential numbering as observed in the final protein",
								"examples": [ 449, 813, null ]
							},
							"Mutations": {
								"type": "array",
								"minItems": 1,
								"maxItems": 2,
								"uniqueItems": true,
								"items": {
									"type": "string",
									"pattern": "^[GK][0-9]{1,4}([A-Z]|del)$"
								},
								"description": "Uses standard mutation notation. Must be a substitution or deletion of one or both residues in the GK sequence",
								"examples": [
									[ "G712del", "K712del" ],
									[ "K447del" ]
								],
								"$comment": "`#/$defs/mutationsAllTypes` is not referenced as the pattern is more constrained here - no insertions and only one or two mutations in total"
							}
						}
					}
				}
			],
			"description": "A range of residues encoded by the C gene segment which is equivalent to the CHS region or the protein. This is normally the last two residues and the standard sequence is GK. Unusual residues and deletions are listed in the `Mutations` subproperty. Commonly the last K is deleted. If both residues are deleted, the `Start` and `End` subproperties are null and the deletions are listed. If the chain is truncated beyond the two CHS residues, the whole `CHSRange` property will be absent.",
			"examples": [
				[
					{
						"Instance": 3,
						"Start": null,
						"End": null,
						"Mutations": [ "G712del", "K712del" ]
					}
				],
				[
					{
						"Instance": 1,
						"Start": 448,
						"End": 448,
						"Mutations": [ "K449del" ]
					},
					{
						"Instance": 2,
						"Start": 446,
						"End": 446,
						"Mutations": [ "K447del" ]
					}
				]
			],
			"$comment": "`#/$defs/singleInstanceRange` is not used as the constraints are slightly different (`Start` and `End` can be null here)"
		},
		"CDRSource": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Species"
						],
						"properties": {
							"Instances": {
								"minItems": 1,
								"maxItems": 2
							},
							"Species": {
								"$ref": "#/$defs/speciesBinomial"
							},
							"Regions": {
								"type": "array",
								"minItems": 1,
								"maxItems": 5,
								"uniqueItems": true,
								"items": {
									"enum": [ "L1", "L2", "L3", "H1", "H2", "H3" ]
								},
								"description": "",
								"examples": [
									[ "L1", "L2", "L3" ],
									[ "H1", "H2", "H3" ]
								]
							}
						}
					}
				}
			],
			"description": "Used for humanized antibodies to specify the source species of the complementarity-determining regions (CDRs) for each instance or pair of instances that contribute to an antigen-combining site. If different CDRs of the same instance have come from different sources, these are listed in separate items and the optional `Regions` subproperty is used to differentiate them.",
			"examples": [
				[
					{
						"Instances": [ 1, 2 ],
						"Species": "Oryctolagus cuniculus",
						"Note": "humanized by CDR grafting"
					},
					{
						"Instances": [ 3, 8 ],
						"Species": "Homo sapiens",
						"Note": "transgenic mouse with human genes"
					},
					{
						"Instances": [ 4, 5 ],
						"Species": "Oryctolagus cuniculus",
						"Note": "humanized by CDR grafting"
					},
					{
						"Instances": [ 6, 7 ],
						"Species": "Oryctolagus cuniculus",
						"Note": "humanized by CDR grafting"
					}
				],
				[
					{
						"Instances": [ 0 ],
						"Regions": [ "L1", "L2", "L3" ],
						"Species": "Homo sapiens"
					},
					{
						"Instances": [ 0 ],
						"Regions": [ "H1", "H2", "H3" ],
						"Species": "Lama glama"
					}
				]
			]
		},
		"Interaction": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 2
							}
						}
					}
				}
			],
			"description": "Indicates non-antibody domains that interact",
			"examples": [
				[
					{
						"Instances": [ 1, 3 ],
						"Note": "Experimentally-determined Kd of 10 nM"
					}
				]
			],
			"$comment": "TODO: check if this annotation only ever applies to exactly 2 instances, in which case the `Instances` array should be further constrained"
		}
	},
	"patternProperties": {
		"^(Heavy|Light)Source$": {
			"type": "string",
			"minLength": 3,
			"description": "States the source of the heavy and light chains (in two separate properties) when they are of different origins",
			"examples": [
				"human",
				"humanized",
				"chimeric"
			],
			"$comment": "HeavySource and LightSource could be changed to arrays of instances, like all of the other Heavy/Light versions of properties. The only reason they are here is that the INN format documentation suggests they will only be used in standard antibody formats, unlike the other Heavy/Light properties, which can take instance qualifiers and are only stripped of the Heavy/Light prefix when the chain cannot be assigned as predominantly heavy or light."
		},
		"^(Request|ID|AbML|(Heavy|Light)Source)-Note$": {
			"type": "string",
			"minLength": 3,
			"description": "Any additional information relating to one of the properties in the name pattern"
		},
		"^Antigen|Binding$": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Species",
							"Names",
							"Gene"
						],
						"properties": {
							"Instances": {
								"minItems": 1,
								"maxItems": 2,
								"examples": [
									[ 0 ],
									[ 1, 2 ],
									[ 4, 5 ]
								]
							},
							"Species": {
								"type": "string",
								"minLength": 3,
								"description": "The common name of the species in which the antigen/binding target is found",
								"examples": [ "human", "dog" ],
								"$comment": "could add a pattern or enumerated list of possible species (`human` and `dog` are the only ones in the sample files)"
							},
							"Names": {
								"type": "string",
								"minLength": 3,
								"description": "The name of the antigen/binding target, followed by any pseudonyms separated by commas. Any greek characters are expanded to their Latin-script alphabet names e.g. alpha, beta, gamma.",
								"examples": [
									"Interleukin 31",
									"T-cell surface glycoprotein CD3 epsilon chain, T-cell surface antigen T3/Leu-4 epsilon chain, CD3e",
									"Interleukin-5, IL-5, B-cell differentiation factor I, Eosinophil differentiation factor, T-cell replacing factor",
									"Receptor tyrosine-protein kinase erbB-2, metastatic lymph node gene 19 protein, MLN19, Proto-oncogene Neu, Proto-oncogene c-ErbB-2, Tyrosine kinase-type cell surface receptor HER2, epidermal growth factor receptor 2, p185erbB2, CD340"
								],
								"$comment": "consider splitting the string of names into an array"
							},
							"Gene": {
								"type": "string",
								"pattern": "^[-A-Z0-9]{2,}$",
								"description": "The name of the gene (official gene symbol) of which the antigen/binding target is the product",
								"examples": [ "CD3E", "TNFSF9", "ALB", "C2" ]
							}
						}
					}
				}
			],
			"description": "The antigen (or antigens in the case of multispecifics) that is the binding target of this antibody. The `Binding` property name is a more general form of `Antigen` and is used for fused non-antibody domains (e.g. anticalins), where the binding targets are not referred to as antigens. Each annotation (item) includes the name (and pseudonyms) of the antigen, the common name of the species, the name of the gene, and the antibody instance(s) containing the variable domains that form the antigen-combining site (paratope) for that particular antigen. In rare cases (see second example below, which is from Request 12086), two different antigens bind the same instances of the antibody, in which case there may be a `Note` subproperty to indicate which CDRs are involved in each binding interaction.",
			"examples": [
				[
					{
						"Instances": [ 1, 2 ],
						"Species": "human",
						"Names": "T-cell surface glycoprotein CD3 epsilon chain, T-cell surface antigen T3/Leu-4 epsilon chain, CD3e",
						"Gene": "CD3E"
					},
					{
						"Instances": [ 3, 8 ],
						"Species": "human",
						"Names": "B-lymphocyte antigen CD19, B-lymphocyte surface antigen B4, T-cell surface antigen Leu-12",
						"Gene": "CD19"
					},
					{
						"Instances": [ 4, 5 ],
						"Species": "human",
						"Names": "programmed cell death 1 ligand 1, PD-L1, programmed death ligand 1, PDCD1 ligand 1, B7 homolog 1, B7-H1",
						"Gene": "CD274"
					},
					{
						"Instances": [ 6, 7 ],
						"Species": "human",
						"Names": "Tumor necrosis factor ligand superfamily member 9, 4-1BB ligand, 4-1BBL",
						"Gene": "TNFSF9"
					}
				],
				[
					{
						"Instances": [ 1, 2 ],
						"Species": "human",
						"Names": "vascular endothelial growth factor A, VEGF-A, Vascular permeability factor, VPF",
						"Gene": "VEGFA",
						"Note": "CDRs L1 L3 H2"
					},
					{
						"Instances": [ 1, 2 ],
						"Species": "human",
						"Names": "Angiopoietin-2, ANG-2",
						"Gene": "ANGPT2",
						"Note": "CDRs L2 H1 H3"
					}
				]
			]
		},
		"^(Heavy|Light)ChainLength$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"required": [
						"Value"
					],
					"items": {
						"Value": {
							"type": "integer",
							"minimum": 1,
							"description": "The number of residues in the chain"
						}
					}
				}
			],
			"description": "The total number of amino acids in the heavy or light chain. In the case of fusions, this property applies to the N-terminal antibody heavy or light chain. It is the full length of the chain including any fusion proteins (but these are not included in the `Instance` subproperty). In cases where you can't assign chains as (predominantly) heavy or light, the `ChainLength` property is used instead (see `#/properties/ChainLength/description` for more details.",
			"examples": [
				[
					{
						"Instance": 8,
						"Value": 214
					}
				],
				[
					{
						"Instance": 1,
						"Value": 448
					},
					{
						"Instance": 2,
						"Value": 446
					}
				]
			]
		},
		"^(Heavy|Light)NGlycos|HeavyOGlycos$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"$ref": "#/$defs/glycosItemProps"
				}
			],
			"description": "Arrays of residue positions that are sites of N-linked glycosylation in light or heavy chains, or O-linked glycosylation in heavy chains, depending on the property name. Note that O-linked glycosylation is not observed in light chains, so `LightOGlycos` is not a valid property name. For each instance, the positions are listed separately for potential sites (predicted from sequence information, such as the characteristic `N-{P}-[ST]-{P}` motif for N-linked glycosylation) and for the subset of these sites that have been experimentally confirmed. There are also separate optional arrays for sites with only partial or rare occupancy of the glycosylation (these annotations are mutually exclusive with the sites in the basic `Confirmed` array).",
			"examples": [
				[
					{
						"Instance": 0,
						"Potential": [ 296 ],
						"Confirmed": [ 296 ]
					}
				],
				[
					{
						"Instance": 1,
						"Potential": [ 52, 306 ],
						"Confirmed": [ 306 ],
						"ConfirmedPartial": [ 52 ]
					},
					{
						"Instance": 3,
						"Potential": [ 52, 306 ],
						"Confirmed": [ 306 ]
					},
					{
						"Instance": 4,
						"Potential": null,
						"Confirmed": null
					},
					{
						"Instance": 7,
						"Potential": null,
						"Confirmed": null
					}
				]
			],
			"$comment": "See also: `#/patternProperties/^(N|O)Glycos$` - this covers the same annotations but for chains that can't be assigned as predominantly heavy or light (e.g. fusions), which may contain glycosylation annotations for linker regions, which require an array for the `Instances` item property"
		},
		"^(N|O)Glycos$": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 1
							}
						}
					}
				},
				{
					"$ref": "#/$defs/glycosItemProps"
				}
			],
			"description": "Used instead of `#/patternProperties/^(Heavy|Light)NGlycos|HeavyOGlycos$` for linker regions and chains that cannot be assigned as predominantly heavy or light.",
			"examples": [
				[
					{
						"Instances": [ 1, 2 ],
						"Potential": [ 293 ],
						"Confirmed": [ 293 ]
					},
					{
						"Instances": [ 3, 4 ],
						"Potential": null,
						"Confirmed": null
					}
				],
				[
					{
						"Instances": [ 1 ],
						"Potential": [ 6, 90, 119, 221, 255, 300, 488, 512 ],
						"Confirmed": [ 6, 90, 300, 488, 512 ]
					}
				]
			]
		},
		"^(Heavy|Light)ConfirmedPTM$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"$ref": "#/$defs/confirmedPTMItemProps"
				}
			],
			"description": "Arrays of residue positions in each instance of a heavy or light chain that have been confirmed by the INN applicant as sites of post-translational modifications (PTMs). Separate items are used for each type of PTM, and separate array subproperties are used for confirmed sites and optionally those where only partial or rare occupancy has been confirmed at the site.",
			"examples": [
				[
					{
						"Instance": 0,
						"Type": "nterpca",
						"Positions": [ 1 ]
					},
					{
						"Instance": 0,
						"Type": "deamidation",
						"PositionsPartial": [ 31, 322 ]
					},
					{
						"Instance": 0,
						"Type": "oxidation",
						"PositionsRare": [ 425 ]
					}
				],
				[
					{
						"Instance": 0,
						"Type": "deamidation",
						"PositionsRare": [ 25 ],
						"PositionsPartial": [ 171 ]
					},
					{
						"Instance": 0,
						"Type": "isomerization",
						"PositionsRare": [ 49, 50, 52, 81, 84, 91, 95 ]
					}
				]
			],
			"$comment": "`#/properties/ConfirmedPTM` is separate as it uses `#/$defs/multiInstancesObjectsArray`"
		},
		"^(Heavy|Light)CysPositions$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"items": {
						"required": [
							"Values"
						],
						"properties": {
							"Values": {
								"$ref": "#/$defs/residuePositionsArray",
								"description": "The cysteine positions(s) for the instance given in the item. Uses sequential numbering as observed in the final protein."
							}
						}
					}
				}
			],
			"description": "An array of cysteine positions in each instance that makes up all or part of a heavy or light chain",
			"examples": [
				[
					{
						"Instance": 1,
						"Values": [ 23, 88 ]
					},
					{
						"Instance": 5,
						"Values": [ 887, 952 ]
					},
					{
						"Instance": 7,
						"Values": [ 1142, 1207 ]
					},
					{
						"Instance": 8,
						"Values": [ 23, 88, 134, 194, 214 ]
					}
				],
				[
					{
						"Instance": 2,
						"Values": [ 154, 227 ]
					},
					{
						"Instance": 3,
						"Values": [ 284, 358, 410, 466, 486, 492, 495, 527, 587, 633, 691 ]
					},
					{
						"Instance": 4,
						"Values": [ 744, 758, 773, 820 ]
					},
					{
						"Instance": 6,
						"Values": [ 1005, 1078 ]
					}
				]
			],
			"$comment": "See also: `#/properties/CysPositions`"
		},
		"^(Heavy|Light)DisulfidesIntra|FusionProtein(Heavy|Light)?Disulfides$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"$ref": "#/$defs/disulfidesIntraItemProps"
				}
			],
			"description": "Arrays of residue pairs involved in intra-chain disulfide bonds in each instance of a heavy chain, light chain, or fusion protein. Separate items are used in cases of multiple disulfide isoforms, and these are indicated in the optional `Isoform` subproperty.",
			"examples": [
				[
					{
						"Instance": 2,
						"Positions": [
							[ 154, 227 ]
						]
					},
					{
						"Instance": 3,
						"Positions": [
							[ 284, 358 ],
							[ 410, 466 ],
							[ 527, 587 ],
							[ 633, 691 ]
						]
					},
					{
						"Instance": 4,
						"Positions": [
							[ 744, 820 ],
							[ 758, 773 ]
						]
					},
					{
						"Instance": 6,
						"Positions": [
							[ 1005, 1078 ]
						]
					}
				],
				[
					{
						"Instance": 1,
						"Positions": [
							[ 23, 88 ]
						]
					},
					{
						"Instance": 5,
						"Positions": [
							[ 887, 952 ]
						]
					},
					{
						"Instance": 7,
						"Positions": [
							[ 1142, 1207 ]
						]
					},
					{
						"Instance": 8,
						"Positions": [
							[ 23, 88 ],
							[ 134, 194 ]
						]
					}
				]
			],
			"$comment": "See also: `#/properties/DisulfidesIntra`"
		},
		"^DisulfidesInterL[1-9]H[1-9]$": {
			"allOf": [
				{
					"$ref": "#/$defs/disulfidesInterItemProps"
				},
				{
					"items": {
						"required": [
							"InstanceL",
							"InstanceH"
						]						
					}
				}
			],
			"description": "Lists residue pairs involved in inter-chain disulfides between a heavy and light chain (which often have the same instance number, as in standard formats, but this isn't the case for most other formats). Uses sequential numbering as observed in the final protein. Separate items are used in cases of multiple disulfide isoforms, and these are indicated in the optional `Isoform` subproperty at the root level of the items (not within the `Positions` items). In most cases, a property matching this pattern (usually with the `L1H1` or `L2H2` suffix) will have only one item (if there are no isoforms) with only one pair of positions (if no additional disulfides have been introduced compared to natural IgGs).",
			"examples": [
				[
					{
						"InstanceL": 8,
						"InstanceH": 3,
						"Positions": [
							{
								"L": 214,
								"H": 486
							}
						]
					}
				],
				null
			],
			"$comment": "TODO: We could consider aggregating all of the DisulfidesInter* properties by moving the chain pair suffix out of the property name and into an item subproperty"
		},
		"^(HV|HJ|LV|LJ)Germline$": {
			"$ref": "#/$defs/germlineProps",
			"description": "The IMGT germline assignment (including species name) for the heavy or light chain variable or joining fragment for each instance. A separate property is used for each type of germline fragment.",
			"examples": [
				[
					{
						"Instance": 1,
						"Species": "Homo sapiens",
						"GeneID": "IGKV1-5*01"
					},
					{
						"Instance": 5,
						"Species": "Homo sapiens",
						"GeneID": "IGKV1-5*03"
					},
					{
						"Instance": 7,
						"Species": "Homo sapiens",
						"GeneID": "IGKV1-39*01"
					},
					{
						"Instance": 8,
						"Species": "Homo sapiens",
						"GeneID": "IGKV1-13*02"
					}
				],
				[
					{
						"Instance": 1,
						"Species": "Homo sapiens",
						"GeneID": "IGKJ4*01"
					},
					{
						"Instance": 5,
						"Species": "Homo sapiens",
						"GeneID": "IGKJ4*01"
					},
					{
						"Instance": 7,
						"Species": "Homo sapiens",
						"GeneID": "IGKJ4*01"
					},
					{
						"Instance": 8,
						"Species": "Homo sapiens",
						"GeneID": "IGKJ3*01"
					}
				]
			],
			"$comment": "See also: `#/properties/HCGermline` and `#/properties/LCGermline`"
		},
		"^(VH|VL)Range$": {
			"$ref": "#/$defs/singleInstanceRange",
			"description": "The range of residues encoded by the V(D)J gene segments and equivalent to the VH or VL domain. Uses sequential numbering as observed in the final protein.",
			"examples": [
				[
					{
						"Instance": 2,
						"Start": 133,
						"End": 252
					},
					{
						"Instance": 3,
						"Start": 263,
						"End": 383
					}
				]
			],
			"$comment": "`Mutations` is not added as an item property (as in the constant domain range annotations), since by definition these domains are too variable (in the final protein) for the idea of a germline reference sequence to make sense"
		},
		"^(CH1|Hinge|CH2|CH3|CH4|CL)Range$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceRange"
				},
				{
					"items": {
						"properties": {
							"Mutations": {
								"$ref": "#/$defs/mutationsAllTypes"
							}
						}
					}
				}
			],
			"description": "The range of residues encoded by the C gene segment which is equivalent to one of the constant domains (CL, CH1, CH2, CH3, or CH4) or the hinge region (between CH1 and CH2) in the protein. CH4Range will only be present for IgM and IgE antibodies. If there are any differences (substitutions, insertions or deletions) from the germline-encoded sequence, these are indicated in the optional `Mutations` subproperty.",
			"examples": [
				[
					{
						"Instance": 1,
						"Start": 127,
						"End": 224,
						"Mutations": [ "K156E", "K222E" ]
					},
					{
						"Instance": 3,
						"Start": 127,
						"End": 224,
						"Mutations": [ "K156E", "K222E" ]
					}
				],
				[
					{
						"Instance": 3,
						"Start": 244,
						"End": 260,
						"Mutations": [ "C248S", "ins259P", "ins260C" ]
					}
				]
			]
		},
		"^CDRKabat(L|H)[1-3]$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceRange"
				},
				{
					"items": {
						"required": [
							"Sequence"
						],
						"properties": {
							"Sequence": {
								"$ref": "#/$defs/aminoAcidSequence"
							}
						}
					}
				}
			],
			"description": "Specifies the amino acid sequence of one of the complementarity-determining regions (CDRs), a.k.a. hypervariable loops, as defined by the Kabat numbering scheme (which is based on sequence variability, as opposed to other schemes like Chothia or IMGT, which are based on structural features or a combination of sequence and structure).",
			"examples": [
				[
					{
						"Instance": 1,
						"Sequence": "QGYFYFISRTYVNS",
						"Start": 89,
						"End": 102
					},
					{
						"Instance": 5,
						"Sequence": "QQGYSWGNVDNV",
						"Start": 953,
						"End": 964
					},
					{
						"Instance": 7,
						"Sequence": "QSTYLGTDYVGGA",
						"Start": 1208,
						"End": 1220
					},
					{
						"Instance": 8,
						"Sequence": "QQFNSYPFT",
						"Start": 89,
						"End": 97
					}
				],
				[
					{
						"Instance": 2,
						"Sequence": "VITGRDITYYASWAKG",
						"Start": 182,
						"End": 197
					},
					{
						"Instance": 3,
						"Sequence": "IIYPDDSDTRYSPSFQG",
						"Start": 312,
						"End": 328
					},
					{
						"Instance": 4,
						"Sequence": "CIAAGSAGITYDANWAKG",
						"Start": 773,
						"End": 790
					},
					{
						"Instance": 6,
						"Sequence": "TISSGGNVYYASSARG",
						"Start": 1033,
						"End": 1048
					}
				]
			]
		},
		"^FusionProtein(Heavy|Light)?$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceRange"
				},
				{
					"items": {
						"properties": {
							"Multimer": {
								"type": "string",
								"pattern": "^(di|tri|tetra|penta|hexa|hepta|octa|nona|deca)mer$",
								"description": "An optional indicator of the homo-multimerization state of the fusion protein",
								"examples": [
									"dimer",
									"trimer",
									"tetramer"
								]
							}
						}
					}
				}
			],
			"description": "Indicates a range of residues within a chain that are part of a fusion protein. When the antibody part of the chain cannot be assigned as either predominantly heavy or light, the (Heavy|Light) suffix is left out of the property name.",
			"examples": [
				[
					{
						"Instance": 1,
						"Start": 1,
						"End": 525
					}
				],
				[
					{
						"Instance": 2,
						"Start": 443,
						"End": 970,
						"Multimer": "trimer"
					}
				]
			]
		},
		"^(FusionProtein(Heavy|Light)?Linker|Linker)$": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"properties": {
							"Instances": {
								"minItems": 2,
								"maxItems": 2,
								"description": "The two consecutive instances connected by the linker region",
								"examples": [
									[ 4, 5 ],
									[ 1, 2 ]
								]
							}
						}
					}
				},
				{
					"$ref": "#/$defs/startEndRequiredInItems"
				}
			],
			"description": "A range indicating the residue positions of the linker between two consecutive instances in a fused chain. `Linker` is used for connections between antibody domains, while `FusionProtein(Heavy|Light)?Linker` is used for connections between a non-antibody fusion protein and an antibody chain (heavy, light, or neither predominantly heavy or light).",
			"examples": [
				[
					{
						"Instances": [ 1, 2 ],
						"Start": 113,
						"End": 132
					},
					{
						"Instances": [ 2, 3 ],
						"Start": 253,
						"End": 262
					},
					{
						"Instances": [ 3, 4 ],
						"Start": 712,
						"End": 722
					}
				]
			]
		},
		"^Mutation(H|L)?$": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"items": {
						"required": [
							"Mutations",
							"Reason"
						],
						"properties": {
							"Mutations": {
								"$ref": "#/$defs/mutationsAllTypes"
							},
							"Reason": {
								"type": "string",
								"minLength": 1,
								"description": "A concise summary of the purpose of the mutation(s)",
								"examples": [
									"Enforce pairing",
									"disulfide",
									"heterodimer formation hole",
									"remove glycosylation site",
									"hinge stabilization"
								]
							}
						}
					}
				}
			],
			"description": "Records the purpose of a set of mutations. The mutations are grouped according to their shared purpose, rather than all mutations in the same instance of the antibody. The H|L suffix is used or left out of the property name depending on if the chain is predominantly heavy, light, or neither.",
			"examples": [
				[
					{
						"Instance": 3,
						"Mutations": ["L500A", "L501A", "G503A", "K588A"],
						"Reason": "Reduce ADCC and CDC"
					},
					{
						"Instance": 3,
						"Mutations": ["G712del", "K712del"],
						"Reason": "Remove CHS"
					}
				]
			]
		},
		"^(Heavy|Light)?Chain$": {
			"allOf": [
				{
					"$ref": "#/$defs/multiInstancesObjectsArray"
				},
				{
					"items": {
						"required": [
							"Sequence"
						],
						"properties": {
							"Instances": {
								"minItems": 1
							},
							"Sequence": {
								"$ref": "#/$defs/aminoAcidSequence"
							}
						}
					}
				}
			],
			"description": "The amino acid sequence of each complete heavy or light chain (listed within separate properties), including all instances that are fused together. Chains that cannot be assigned as primarily heavy or light are listed under the property name without the `Heavy` or `Light` prefix.",
			"examples": [
				[
					{
						"Instances": [ 1, 2, 3, 4, 5, 6, 7 ],
						"Sequence": "DVVMTQSPSTLSASVGDRVTINCQASESISSWLAWYQQKPGKAPKLLIYEASKLASGVPSRFSGSGSGTEFTLTISSLQPDDFATYYCQGYFYFISRTYVNSFGGGTKVEIKGGGGSGGGGSGGGGSGGGGSEVQLVESGGGLVQPGGSLRLSCAASGFTISTNAMSWVRQAPGKGLEWIGVITGRDITYYASWAKGRFTISRDNSKNTLYLQMNSLRAEDTAVYYCARDGGSSAITSNNIWGQGTLVTVSSGGGGSGGGGSEVQLVQSGAEVKKPGESLKISCKGSGYSFSSSWIGWVRQAPGKGLEWMGIIYPDDSDTRYSPSFQGQVTISADKSIRTAYLQWSSLKASDTAMYYCARHVTMIWGVIIDFWGQGTLVTVSSASTKGPSVFPLAPSSKSTSGGTAALGCLVKDYFPEPVTVSWNSGALTSGVHTFPAVLQSSGLYSLSSVVTVPSSSLGTQTYICNVNHKPSNTKVDKRVEPKSCDKTHTCPPCPAPEAAGAPSVFLFPPKPKDTLMISRTPEVTCVVVDVSHEDPEVKFNWYVDGVEVHNAKTKPREEQYNSTYRVVSVLTVLHQDWLNGKEYKCAVSNKALPAPIEKTISKAKGQPREPQVYTLPPSRDELTKNQVSLTCLVKGFYPSDIAVEWESNGQPENNYKTTPPVLDSDGSFFLYSKLTVDKSRWQQGNVFSCSVMHEALHNHYTQKSLSLSPGGGGGSGGGGSEVQLLESGGGLVQPGGSLRLSCAASGFSFSSGYDMCWVRQAPGKGLEWIACIAAGSAGITYDANWAKGRFTISRDNSKNTLYLQMNSLRAEDTAVYYCARSAFSFDYAMDLWGQGTLVTVSSGGGGSGGGGSGGGGSGGGGSDIQMTQSPSTLSASVGDRVTITCQASQSISSHLNWYQQKPGKAPKLLIYKASTLASGVPSRFSGSGSGTEFTLTISSLQPDDFATYYCQQGYSWGNVDNVFGGGTKVEIKGGGGSGGGGSRSLVESGGGLVQPGGSLRLSCTASGFTISSYHMQWVRQAPGKGLEYIGTISSGGNVYYASSARGRFTISRPSSKNTVDLQMNSLRAEDTAVYYCARDSGYSDPMWGQGTLVTVSSGGGGSGGGGSGGGGSGGGGSDVVMTQSPSSVSASVGDRVTITCQASQNIRTYLSWYQQKPGKAPKLLIYAAANLASGVPSRFSGSGSGTDFTLTISDLEPGDAATYYCQSTYLGTDYVGGAFGGGTKVEIK"
					}
				],
				[
					{
						"Instances": [ 1 ],
						"Sequence": "QIVLTQSPATLSLSPGERATLSCSASSKHTNLYWSRHMYWYQQKPGQAPRLLIYLTSNRATGIPARFSGSGSGTDFTLTISSLEPEDFAVYYCQQWSSNPFTFGQGTKLEIKRTVAAPSVFIFPPSDEQLKSGTASVVCLLNNFYPREAKVQWKVDNALQSGNSESVTEQDSKDSTYSLSSTLTLSKADYEKHKVYACEVTHQGLSSPVTKSFNRGEC"
					},
					{
						"Instances": [ 2 ],
						"Sequence": "DIQMTQSPSSLSASVGDRVTITCRASQSINSYLDWYQQKPGKAPKLLIYAASSLQSGVPSRFSGSGSGTDFTLTISSLQPEDFATYYCQQYYSTPFTFGPGTKVEIKGQPKAAPSVTLFPPCSEELQANKATLVCLISDFYPGAVTVAWKADSSPVKAGVETTTPSKQSNNKYAASSYLSLTPEQWKSHRSYSCQVTHEGSTVEKTVAPTEVS"
					}
				]
			]
		}
	},
	"$defs": {
		"germlineProps": {
			"allOf": [
				{
					"$ref": "#/$defs/singleInstanceObjectsArray"
				},
				{
					"items": {
						"required": [
							"Species",
							"GeneID"
						],
						"properties": {
							"Species": {
								"$ref": "#/$defs/speciesBinomial"
							},
							"GeneID": {
								"type": "string",
								"pattern": "^IG[HKL][GCVJ][0-9]{0,2}D?(-[0-9]{0,3}){0,2}\\*0[1-9]$",
								"description": "The IMGT gene name, including the allele number; see https://www.imgt.org/IMGTScientificChart/Nomenclature/IMGTnomenclature.php for details about the nomenclature",
								"examples": [
									"IGHG1*03",
									"IGHJ3*01",
									"IGHV4-31*02",
									"IGHV3-30-3*01",
									"IGKC*01",
									"IGKV3D-7*01",
									"IGLJ7*01"
								],
								"$comment": "TODO: consider a simpler pattern (e.g. `^IG[HKL][GCVJ][0-9D-]*\\*0[1-9]$`), or more specific validation - a different GeneID pattern for each of the six *Germline records"
							}
						}
					}
				}
			],
			"$comment": "Referenced in all *Germline properties or patternProperties"
		},
		"singleInstanceRange": {
			"allOf": [
				{
					"$ref": "#/$defs/startEndRequiredInItems"
				}
			],
			"$ref": "#/$defs/singleInstanceObjectsArray",
			"$comment": "Used as a base schema by all properties with annotations that apply to single instances and contain a range of residue numbers (start and end positions)"
		},
		"multiInstancesObjectsArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"type": "object",
				"required": [
					"Instances"
				],
				"unevaluatedProperties": false,
				"properties": {
					"Instances": {
						"type": "array",
						"uniqueItems": true,
						"items": {
							"type": "integer",
							"minimum": 0
						},
						"description": "The instance(s) (chain or single-origin portion of a fused chain) to which the item's other properties apply. A single-item array with the number 0 is used as a default for standard antibodies without any other instances.",
						"$comment": "The `minItems` validation keyword is added to all subschemas that reference and extend `multiInstancesObjectsArray`. This is to disallow an empty array of `Instances`. It is not defined here because different groups of properties require different constraints: most will simply be at least 1 item of `Instances`, but some should have at least 2 (e.g. `Fusion`). The `maxItems` keyword is added to subschemas for properties like `Antigen` and `CDRSource`, which can't have more than two `Instances`, and `Linker` (in patternProperties), which must have exactly two `Instances` for each annotation."
					},
					"Note": {
						"$ref": "#/$defs/note"
					}
				}
			},
			"$comment": "Used as a base schema and extended by properties that can (but don't necessarily always) have multiple annotations per antibody and each annotation can (but doesn't necessarily always) apply to multiple instances"
		},
		"singleInstanceObjectsArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"type": "object",
				"required": [
					"Instance"
				],
				"unevaluatedProperties": false,
				"properties": {
					"Instance": {
						"type": "integer",
						"minimum": 0,
						"description": "The instance (chain or single-origin portion of a fused chain) to which the item's other properties apply. The value 0 is used as a default for standard antibodies without any other instances.",
						"examples": [
							2,
							0
						]
					},
					"Note": {
						"$ref": "#/$defs/note"
					}
				}
			},
			"$comment": "Used as a base schema and extended by all properties that can have multiple annotations per antibody and each annotation only ever applies to a single instance"
		},
		"startEndRequiredInItems": {
			"items": {
				"required": [
					"Start",
					"End"
				],
				"properties": {
					"Start": {
						"type": "integer",
						"minimum": 1,
						"description": "The position of the first residue in the range, using sequential numbering as observed in the final protein",
						"examples": [ 1, 397, 212 ]
					},
					"End": {
						"type": "integer",
						"minimum": 2,
						"description": "The position of the last residue in the range, using sequential numbering as observed in the final protein",
						"examples": [ 396, 211 ]
					}
				}
			},
			"$comment": "Must only be referenced in allOf statements together with `singleInstanceObjectsArray` or `multiInstancesObjectsArray`. Currently referenced within `#/$defs/singleInstanceRange` and the `...Linker` pattern property. Note that `Start` and `End` are always used together and always required where they are used in this schema."
		},
		"heavyDomainsInItems": {
			"items": {
				"properties": {
					"Domains": {
						"type": "array",
						"minItems": 1,
						"uniqueItems": true,
						"items": {
							"type": "string",
							"enum": [ "CH1", "hinge", "CH2", "CH3", "CH4" ],
							"$comment": "not sure if `hinge` should be allowed"
						},
						"description": "An optional indicator of the domain(s), for cases when the constant domains come from different germline loci",
						"examples": [ 
							[ "CH1" ],
							[ "CH2", "CH3" ]
						]
					}
				}
			},
			"$comment": "Must only be referenced in allOf statements together with `#/$defs/singleInstanceObjectsArray` or `#/$defs/multiInstancesObjectsArray`"
		},
		"lightDomainInItems": {
			"items": {
				"properties": {
					"Domain": {
						"type": "string",
						"enum": [ "VL", "CL" ],
						"description": "An optional indicator of the domain, for cases when the variable and constant domains come from different germline loci"
					}
				}
			},
			"$comment": "Must only be referenced in allOf statements together with `#/$defs/singleInstanceObjectsArray` or `#/$defs/multiInstancesObjectsArray`. Currently used in `#/properties/LightChainClass`."
		},
		"glycosItemProps": {
			"items": {
				"required": [
					"Potential",
					"Confirmed"
				],
				"properties": {
					"Potential": {
						"anyOf": [
							{
								"type": "null"
							},
							{
								"$ref": "#/$defs/residuePositionsArray"
							}
						],
						"description": "An array of residue positions that have been identified by the INN applicant as being potentially glycosylated (based on sequence motifs or homology with antibodies with confirmed sites), or null if there are none. Uses sequential numbering as observed in the final protein.",
						"examples": [
							null,
							[ 563 ],
							[ 6, 90, 300, 488, 512 ]
						]
					},
					"Confirmed": {
						"anyOf": [
							{
								"type": "null"
							},
							{
								"$ref": "#/$defs/residuePositionsArray"
							}
						],
						"description": "An array of residue positions that have been confirmed by the INN applicant as being glycosylated, or null if there are none. Uses sequential numbering as observed in the final protein.",
						"examples": [
							null,
							[ 563 ],
							[ 6, 90, 300, 488, 512 ]
						]
					},
					"ConfirmedPartial": {
						"$ref": "#/$defs/residuePositionsArray",
						"description": "An optional array of residue positions that have been experimentally confirmed by the INN applicant as being glycosylated with an intermediate occupancy (less than complete but more than 'rare'). Uses sequential numbering as observed in the final protein.",
						"$comment": "TODO: check the provenance of the frequency/occupancy qualifier terms ('rare' and 'partial') and if they correspond to precise ranges e.g. 1-10% for rare and 10-95% for partial"
					},
					"ConfirmedRare": {
						"$ref": "#/$defs/residuePositionsArray",
						"description": "An optional array of residue positions that have been experimentally confirmed by the INN applicant as being glycosylated with a low occupancy (non-zero but less than 'partial'). Uses sequential numbering as observed in the final protein.",
						"$comment": "TODO: check if other frequency terms are possible (e.g. `common`, `complete`/`full`, `uncertain`), in which case more `Confirmed[Freq]` properties are needed"
					}
				}
			},
			"$comment": "Referenced in allOf statements within all glycosylation-related properties"
		},
		"confirmedPTMItemProps": {
			"items": {
				"anyOf": [
					{ "required": [ "Type", "Positions" ] },
					{ "required": [ "Type", "PositionsPartial" ] },
					{ "required": [ "Type", "PositionsRare" ] }
				],
				"properties": {
					"Type": {
						"type": "string",
						"pattern": "^\\S+$",
						"description": "The type of post-translational modification (PTM)",
						"examples": [
							"cterclip",
							"deamidation",
							"formylglycine",
							"glycation",
							"hydroxylation",
							"isomerization",
							"nterdeformylate",
							"nterpca",
							"oxidation"
						],
						"$comment": "TODO: confirm that only single words are allowed (no whitespace)"
					},
					"Positions": {
						"$ref": "#/$defs/residuePositionsArray",
						"description": "An array of residue positions that have been confirmed by the INN applicant as PTM sites. Uses sequential numbering as observed in the final protein.",
						"examples": [
							[ 723 ],
							[ 33, 99 ]
						],
						"$comment": "Note that unlike for glycosylation properties null values are not allowed here, where the item subproperty or whole property will simply be absent from the JSON instance if there are no such annotations"
					},
					"PositionsPartial": {
						"$ref": "#/$defs/residuePositionsArray",
						"description": "An optional array of residue positions that have been experimentally confirmed by the INN applicant as PTM sites with an intermediate occupancy (less than complete but more than 'rare'). Uses sequential numbering as observed in the final protein.",
						"$comment": "TODO: check the provenance of the frequency/occupancy qualifier terms ('rare' and 'partial') and if they correspond to precise ranges e.g. 1-10% for rare and 10-95% for partial"
					},
					"PositionsRare": {
						"$ref": "#/$defs/residuePositionsArray",
						"description": "An optional array of residue positions that have been experimentally confirmed by the INN applicant as PTM sites with a low occupancy (non-zero but less than 'partial'). Uses sequential numbering as observed in the final protein.",
						"$comment": "TODO: check if other frequency terms are possible (e.g. `common`, `complete`/`full`, `uncertain`), in which case more `Positions[Freq]` properties are needed"
					}
				}
			},
			"$comment": "Referenced in allOf statements within `#/properties/ConfirmedPTM` and `#/patternProperties/^(Heavy|Light)ConfirmedPTM$`"
		},
		"disulfidesIntraItemProps": {
			"items": {
				"required": [
					"Positions"
				],
				"properties": {
					"Isoform": {
						"$ref": "#/$defs/isoform"
					},
					"Positions": {
						"type": "array",
						"minItems": 1,
						"uniqueItems": true,
						"items": {
							"type": "array",
							"minItems": 2,
							"maxItems": 2,
							"uniqueItems": true,
							"items": {
								"type": "integer",
								"minimum": 1
							}
						},
						"description": "The positions of pairs of residues involved in disulfide bonds. Uses sequential numbering as observed in the final protein.",
						"examples": [
							[
								[ 23, 88 ]
							],
							[
								[ 284, 358 ],
								[ 410, 466 ],
								[ 527, 587 ],
								[ 633, 691 ]
							]
						]
					}
				}
			},
			"$comment": "Must only be referenced in allOf statements together with `#/$defs/singleInstanceObjectsArray` or `#/$defs/multiInstancesObjectsArray`. Currently used in `#/properties/DisulfidesIntra` and `#/patternProperties/^(Heavy|Light)DisulfidesIntra|FusionProtein(Heavy|Light)?Disulfides$`."
		},
		"disulfidesInterItemProps": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"type": "object",
				"unevaluatedProperties": false,
				"allOf": [
					{
						"oneOf": [
							{
								"required": [
									"InstanceL",
									"InstanceH"
								],
								"properties": {
									"InstanceL": {
										"type": "integer",
										"minimum": 0,
										"description": "The light chain instance (chain or single-origin portion of a fused chain) of a light-heavy pair with inter-chain disulfides"
									},
									"InstanceH": {
										"type": "integer",
										"minimum": 0,
										"description": "The heavy chain instance (chain or single-origin portion of a fused chain) of a light-heavy pair with inter-chain disulfides"
									}
								},
								"$comment": "This subschema is enforced in `#/patternProperties/^DisulfidesInterL[1-9]H[1-9]$` using the `required` keyword"
							},
							{
								"required": [
									"InstanceX",
									"InstanceY"
								],
								"properties": {
									"InstanceX": {
										"type": "integer",
										"minimum": 0,
										"description": "The first instance (chain or single-origin portion of a fused chain) of a pair of chains with inter-chain disulfides"
									},
									"InstanceY": {
										"type": "integer",
										"minimum": 0,
										"description": "The second instance (chain or single-origin portion of a fused chain) of a pair of chains with inter-chain disulfides"
									}
								},
								"$comment": "This subschema is enforced in `#/Properties/DisulfidesInterH1H2` and `#/Properties/DisulfidesInter` using the `required` keyword"
							}
						]
					},
					{
						"required": [
							"Positions"
						],
						"properties": {
							"Isoform": { "$ref": "#/$defs/isoform" },
							"Positions": {
								"anyOf": [
									{
										"type": "null"
									},
									{
										"type": "array",
										"minItems": 1,
										"uniqueItems": true,
										"items": {
											"type": "object",
											"unevaluatedProperties": false,
											"patternProperties": {
												"^[LHXY]$": {
													"type": "integer",
													"minimum": 1
												}
											},
											"$comment": "The `dependentSchemas` keyword is used below (within the `if-then` statement) to enforce the right pair of required item subproperty names, depending on if the InstanceL/H or InstanceX/Y subproperties are used in parent scope"
										}
									}
								],
								"description": "Each item describes one disulfide-linked residue pair with a chain indicator name and residue position value for each of the two residues. Uses sequential numbering as observed in the final protein. null is also valid (instead of a `Positions` array)."
							},
							"Note": { "$ref": "#/$defs/note" }
						},
						"if": {
							"properties": {
								"Positions": {
									"not": { "type": "null" }
								}
							}
						},
						"then": {
							"dependentSchemas": {
								"InstanceL": {
									"properties": {
										"Positions": {
											"items": {
												"required": [
													"L",
													"H"
												],
												"not": {
													"required": [
														"X",
														"Y"
													]
												}
											}
										}
									}
								},
								"InstanceX": {
									"properties": {
										"Positions": {
											"items": {
												"required": [
													"X",
													"Y"
												],
												"not": {
													"required": [
														"L",
														"H"
													]
												}
											}
										}
									}
								}
							}
						}
					}
				]
			},
			"$comment": "Referenced in `#/patternProperties/^DisulfidesInterL[1-9]H[1-9]$`, `#/properties/DisulfidesInterH1H2`, and `#/properties/DisulfidesInter`"
		},
		"isoform": {
			"type": "string",
			"pattern": "^[A-Z]$",
			"description": "Optional indicator used to differentiate between disulfide isoforms"
		},
		"speciesBinomial": {
			"type": "string",
			"pattern": "^[A-Z][a-z]+\\s[a-z]+$",
			"description": "The binomial name of a species",
			"examples": [
				"Homo sapiens",
				"Canis lupus",
				"Mus musculus",
				"Rattus norvegicus",
				"Lama glama",
				"Oryctolagus cuniculus"
			],
			"$comment": "The common name (e.g. human) is used for the `Species` subproperty of `#/patternProperties/^Antigen|Binding$` instead of this def"
		},
		"mutationsAllTypes": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"type": "string",
				"anyOf": [
					{ "pattern": "^[A-Z][0-9]{1,4}[A-Z]$" },
					{ "pattern": "^ins[0-9]{1,4}$" },
					{ "pattern": "^[A-Z][0-9]{1,4}(-[0-9]{1,4})?del$" }
				]
			},
			"description": "Uses standard mutation nomenclature with 1-letter amino acid codes. Consecutive deleted residues are listed individually.",
			"examples": [
				[ "C248S", "ins259P", "ins260C" ],
				[ "T109A" ],
				[ "Q125-126del", "K712del" ]
			],
			"$comment": "Referenced in `#/patternProperties/^Mutation(H|L)?$` and `#/patternProperties/^(CH1|Hinge|CH2|CH3|CH4|CL)Range$`. The three patterns in the anyOf statement are for substitutions, insertions and deletions respectively."
		},
		"aminoAcidSequence": {
			"type": "string",
			"minLength": 1,
			"pattern": "^[ACDEFGHIKLMNPQRSTVWXY]+$",
			"description": "An amino acid sequence using single-letter codes for the 20 natural amino acids (plus X for non-natural)",
			"examples": [
				"QASQSISSHLN",
				"EASKLAS"
			]
		},
		"residuePositionsArray": {
			"type": "array",
			"minItems": 1,
			"uniqueItems": true,
			"items": {
				"type": "integer",
				"minimum": 1
			},
			"examples": [
				[ 6, 90, 300, 488, 512 ],
				[ 154 ]
			]
		},
		"note": {
			"type": "string",
			"minLength": 2,
			"description": "An optional note that provides further context, detail, or clarification on the information in this item",
			"$comment": "Referenced by other $defs (`singleInstanceObjectsArray`, `multiInstancesObjectsArray`, which are in turn referenced by most root-level properties."
		},
		"requiredProps": {
			"$comment": "This is purely a stylistic schema composition choice. It could also all be written anywhere inline at the schema's root level, but it's hidden away here to reduce clutter, while it's presence is still clear with the $ref near the top of the schema.",
			"required": [
				"Request",
				"Format",
				"Type"
			],
			"allOf": [
				{
					"anyOf": [
						{ "required": [ "ChainLength" ] },
						{ "required": [ "HeavyChainLength" ] },
						{ "required": [ "LightChainLength" ] }
					]					
				},
				{
					"anyOf": [
						{ "required": [ "NGlycos" ] },
						{ "required": [ "HeavyNGlycos" ] },
						{ "required": [ "LightNGlycos" ] }
					]
				},
				{
					"anyOf": [
						{ "required": [ "CysPositions" ] },
						{ "required": [ "HeavyCysPositions" ] },
						{ "required": [ "LightCysPositions" ] }
					]					
				},
				{
					"anyOf": [
						{ "required": [ "DisulfidesIntra" ] },
						{ "required": [ "HeavyDisulfidesIntra" ] },
						{ "required": [ "LightDisulfidesIntra" ] }
					]					
				},
				{
					"anyOf": [
						{ "required": [ "HVGermline" ] },
						{ "required": [ "HJGermline" ] },
						{ "required": [ "HCGermline" ] },
						{ "required": [ "LVGermline" ] },
						{ "required": [ "LJGermline" ] },
						{ "required": [ "LCGermline" ] }
					]					
				},
				{
					"anyOf": [
						{ "required": [ "VHRange" ] },
						{ "required": [ "CH1Range" ] },
						{ "required": [ "CH2Range" ] },
						{ "required": [ "CH3Range" ] },
						{ "required": [ "CH4Range" ] },
						{ "required": [ "VLRange" ] },
						{ "required": [ "CLRange" ] }
					]					
				}
			]
		}
	},
	"TODO:": "Figure out the validation error in singleInstanceRange (`Start` and `End` are unevaluated properties). Even putting the unevaluatedProperties keyword outside the allOf array doesn't work, so it seems the validation tool's annotations don't accumulate beyond the local evaluation context.",
	"$comment": "camelCase is used for $defs names, as per the most common JSON/JSON Schema convention, but the properties names and patternProperties names are in PascalCase, for consistency with the original INN Antibody Annotation Format"
}
